"use strict";(self.wpRiseJsonp=self.wpRiseJsonp||[]).push([["recorder"],{33949:(Ie,z,m)=>{m.r(z),m.d(z,{startRecording:()=>ye});var P=m(91388),rt=m(10144),V=m(78586),S=m(87542),l=m(54203),E=m(62877);const I={FullSnapshot:2,IncrementalSnapshot:3,Meta:4,Focus:6,ViewEnd:7,VisualViewport:8,FrustrationRecord:9},w={Document:0,DocumentType:1,Element:2,Text:3,CDATA:4,DocumentFragment:11},g={Mutation:0,MouseMove:1,MouseInteraction:2,Scroll:3,ViewportResize:4,Input:5,TouchMove:6,MediaInteraction:7,StyleSheetRule:8},T={MouseUp:0,MouseDown:1,Click:2,ContextMenu:3,DblClick:4,Focus:5,Blur:6,TouchStart:7,TouchEnd:9},F={Play:0,Pause:1};var it=m(38549);function C(t,n){const e=t.tagName,o=t.value;if((0,l.Ie)(t,n)){const s=t.type;return e==="INPUT"&&(s==="button"||s==="submit"||s==="reset")?o:!o||e==="OPTION"?void 0:l.o}if(e==="OPTION"||e==="SELECT")return t.value;if(!(e!=="INPUT"&&e!=="TEXTAREA"))return o}const ut=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,at=/^[A-Za-z]+:|^\/\//,ct=/^["']?data:.*,/i;function dt(t,n){return t.replace(ut,(e,o,s,r,u,i)=>{const a=s||u||i;if(!n||!a||at.test(a)||ct.test(a))return e;const c=o||r||"";return`url(${c}${lt(a,n)}${c})`})}function lt(t,n){try{return(0,it.c$)(t,n).href}catch{return t}}const ft=/[^a-z1-6-_]/;function pt(t){const n=t.toLowerCase().trim();return ft.test(n)?"div":n}function k(t){return t.tagName.toLowerCase()}function H(t,n){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${t}' height='${n}' style='background-color:silver'%3E%3C/svg%3E`}function $(t){if(!(t===void 0||t.length===0))return t.map(n=>{const e=n.cssRules||n.rules;return{cssRules:Array.from(e,r=>r.cssText),disabled:n.disabled||void 0,media:n.media.length>0?Array.from(n.media):void 0}})}var ht=m(77448);const mt=1e6;function B(t,n,e,o){if(n===l.$m.HIDDEN)return null;const s=t.getAttribute(e),r=t.tagName;if((0,l.ap)(r,e,s,n,o)){if(r==="IMG"){const u=t;if(u.naturalWidth>0)return H(u.naturalWidth,u.naturalHeight);const{width:i,height:a}=t.getBoundingClientRect();return i>0||a>0?H(i,a):l.eT}return r==="SOURCE"?l.eT:l.o}return s&&(0,l.ei)(s,mt)}function gt(t,n,e){return{...St(t,n,e),...Tt(t,n,e)}}function St(t,n,e){if(n===l.$m.HIDDEN)return{};const o={},s=k(t);for(let u=0;u<t.attributes.length;u+=1){const a=t.attributes.item(u).name,c=B(t,n,a,e.scope.configuration);c!==null&&(o[a]=c)}if(t.value&&(s==="textarea"||s==="select"||s==="option"||s==="input")){const u=C(t,n);u!==void 0&&(o.value=u)}if(s==="option"){const u=t;u.selected&&!(0,l.Ie)(u,n)?o.selected="":delete o.selected}const r=t;return s==="input"&&(r.type==="radio"||r.type==="checkbox")&&(r.checked&&!(0,l.Ie)(r,n)?o.checked="":delete o.checked),o}function Tt(t,n,e){if(n===l.$m.HIDDEN)return{};const o={},s=t.ownerDocument,r=k(t);if(r==="link"){const a=Array.from(s.styleSheets).find(d=>d.href===t.href),c=D(a);c&&a&&(e.addMetric("cssText",c.length),o._cssText=c)}if(r==="style"&&t.sheet){const a=D(t.sheet);a&&(e.addMetric("cssText",a.length),o._cssText=a)}if(r==="audio"||r==="video"){const a=t;o.rr_mediaState=a.paused?"paused":"played"}let u,i;switch(e.kind){case 0:u=Math.round(t.scrollTop),i=Math.round(t.scrollLeft),(u||i)&&e.scope.elementsScrollPositions.set(t,{scrollTop:u,scrollLeft:i});break;case 1:e.scope.elementsScrollPositions.has(t)&&({scrollTop:u,scrollLeft:i}=e.scope.elementsScrollPositions.get(t));break}return i&&(o.rr_scrollLeft=i),u&&(o.rr_scrollTop=u),o}function D(t){if(!t)return null;let n;try{n=t.rules||t.cssRules}catch{}if(!n)return null;const e=Array.from(n,(0,ht.nr)()?yt:U).join("");return dt(e,t.href)}function yt(t){if(Et(t)&&t.selectorText.includes(":")){const n=/(\[[\w-]+[^\\])(:[^\]]+\])/g;return t.cssText.replace(n,"$1\\$2")}return U(t)}function U(t){return It(t)&&D(t.styleSheet)||t.cssText}function It(t){return"styleSheet"in t}function Et(t){return"selectorText"in t}function L(t,n,e){switch(t.nodeType){case t.DOCUMENT_NODE:return vt(t,n,e);case t.DOCUMENT_FRAGMENT_NODE:return Nt(t,n,e);case t.DOCUMENT_TYPE_NODE:return wt(t,e);case t.ELEMENT_NODE:return Mt(t,n,e);case t.TEXT_NODE:return bt(t,n,e);case t.CDATA_SECTION_NODE:return xt(t,e);default:return null}}function O(t,n,e){const o=[];return(0,l.wI)(t,s=>{const r=L(s,n,e);r&&o.push(r)}),o}function vt(t,n,e){return{type:w.Document,id:e.assignId(t),childNodes:O(t,n,e),adoptedStyleSheets:$(t.adoptedStyleSheets)}}function Nt(t,n,e){const o=(0,l.p_)(t);return o&&e.scope.shadowRootsController.addShadowRoot(t,e.scope),{type:w.DocumentFragment,id:e.assignId(t),childNodes:O(t,n,e),isShadowRoot:o,adoptedStyleSheets:o?$(t.adoptedStyleSheets):void 0}}function wt(t,n){return{type:w.DocumentType,id:n.assignId(t),name:t.name,publicId:t.publicId,systemId:t.systemId}}function Mt(t,n,e){const o=pt(t.tagName),s=Rt(t)||void 0,r=(0,l.jR)((0,l.dT)(t),n);if(r===l.$m.HIDDEN){const{width:c,height:d}=t.getBoundingClientRect();return{type:w.Element,id:e.assignId(t),tagName:o,attributes:{rr_width:`${c}px`,rr_height:`${d}px`,[l.NT]:l.Wd},childNodes:[],isSVG:s}}if(r===l.$m.IGNORE)return null;const u=e.assignId(t),i=gt(t,r,e);let a=[];return(0,l.wR)(t)&&o!=="style"&&(a=O(t,r,e)),{type:w.Element,id:u,tagName:o,attributes:i,childNodes:a,isSVG:s}}function Rt(t){return t.tagName==="svg"||t instanceof SVGElement}function bt(t,n,e){const o=(0,l.rf)(t,n);return o===void 0?null:{type:w.Text,id:e.assignId(t),textContent:o}}function xt(t,n){return{type:w.CDATA,id:n.assignId(t),textContent:""}}function Ct(t,n){const e=n.scope.configuration.defaultPrivacyLevel;return L(t,e,n)}function G(){return{cssText:{count:0,max:0,sum:0},serializationDuration:{count:0,max:0,sum:0}}}function J(t,n,e){t[n].count+=1,t[n].max=Math.max(t[n].max,e),t[n].sum+=e}function Dt(t,n){for(const e of["cssText","serializationDuration"])t[e].count+=n[e].count,t[e].max=Math.max(t[e].max,n[e].max),t[e].sum+=n[e].sum}function X(t,n,e,o,s){const r=[],u=G(),i={add(c){r.push(c)},addMetric(c,d){J(u,c,d)},assignId(c){const d=o.nodeIds.assign(c);return i.serializedNodeIds&&i.serializedNodeIds.add(d),d},kind:t,scope:o},a=(0,E.nx)();s(i),J(u,"serializationDuration",(0,E.vk)(a,(0,E.nx)()));for(const c of r)n(c);e(u)}const _=25;function Lt(t){return Math.abs(t.pageTop-t.offsetTop-window.scrollY)>_||Math.abs(t.pageLeft-t.offsetLeft-window.scrollX)>_}const Ot=(t,n)=>{const e=window.visualViewport,o={layoutViewportX:t,layoutViewportY:n,visualViewportX:t,visualViewportY:n};if(e)Lt(e)?(o.layoutViewportX=Math.round(t+e.offsetLeft),o.layoutViewportY=Math.round(n+e.offsetTop)):(o.visualViewportX=Math.round(t-e.offsetLeft),o.visualViewportY=Math.round(n-e.offsetTop));else return o;return o},W=t=>({scale:t.scale,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,pageLeft:t.pageLeft,pageTop:t.pageTop,height:t.height,width:t.width});function At(t,n,e,o,s){Y((0,E.nx)(),0,n,e,s);const{unsubscribe:r}=t.subscribe(2,u=>{o(),Y(u.startClocks.timeStamp,1,n,e,s)});return{stop:r}}function Y(t,n,e,o,s){X(n,e,o,s,r=>{const{width:u,height:i}=(0,l.pB)();r.add({data:{height:i,href:window.location.href,width:u},type:I.Meta,timestamp:t}),r.add({data:{has_focus:document.hasFocus()},type:I.Focus,timestamp:t}),r.add({data:{node:Ct(document,r),initialOffset:{left:(0,l.Gn)(),top:(0,l.zL)()}},type:I.FullSnapshot,timestamp:t}),window.visualViewport&&r.add({data:W(window.visualViewport),type:I.VisualViewport,timestamp:t})})}function zt(){const t=new WeakMap;let n=0;const e=o=>t.get(o);return{assign:o=>{let s=e(o);return s===void 0&&(s=n++,t.set(o,s)),s},get:e,areAssignedForNodeAndAncestors:o=>{let s=o;for(;s;){if(e(s)===void 0&&!(0,l.p_)(s))return!1;s=(0,l.$4)(s)}return!0}}}function Ee({configuration:t}={}){const n=[],e=o=>{n.push(o)};return doTakeFullSnapshot(timeStampNow(),0,e,noop,j(t)),n}function ve(t,{configuration:n}={}){let e=null;return serializeInTransaction(0,noop,noop,j(n),o=>{const s=getNodePrivacyLevel(t,o.scope.configuration.defaultPrivacyLevel);s===NodePrivacyLevel.HIDDEN||s===NodePrivacyLevel.IGNORE||(e=serializeNode(t,s,o))}),e}function j(t){return createRecordingScope({defaultPrivacyLevel:NodePrivacyLevel.ALLOW,...t},createElementsScrollPositions(),createEventIds(),createNodeIds(),{addShadowRoot:noop,removeShadowRoot:noop,flush:noop,stop:noop})}var Pt=m(45377),x=m(93642),M=m(91045);function K(t){return!!t.changedTouches}function R(t){return t.composed===!0&&(0,l.XS)(t.target)?t.composedPath()[0]:t.target}function y(t,n){return{data:{source:t,...n},type:I.IncrementalSnapshot,timestamp:(0,E.nx)()}}const Vt=50;function Ft(t,n){const{throttled:e,cancel:o}=(0,S.n)(r=>{const u=R(r),i=n.nodeIds.get(u);if(i===void 0)return;const a=Z(r);if(!a)return;const c={id:i,timeOffset:0,x:a.x,y:a.y};t(y(K(r)?g.TouchMove:g.MouseMove,{positions:[c]}))},Vt,{trailing:!1}),{stop:s}=(0,M.l)(n.configuration,document,["mousemove","touchmove"],e,{capture:!0,passive:!0});return{stop:()=>{s(),o()}}}function Z(t){let{clientX:n,clientY:e}=K(t)?t.changedTouches[0]:t;if(window.visualViewport){const{visualViewportX:o,visualViewportY:s}=Ot(n,e);n=o,e=s}if(!(!Number.isFinite(n)||!Number.isFinite(e)))return{x:n,y:e}}const Q={pointerup:T.MouseUp,mousedown:T.MouseDown,click:T.Click,contextmenu:T.ContextMenu,dblclick:T.DblClick,focus:T.Focus,blur:T.Blur,touchstart:T.TouchStart,touchend:T.TouchEnd};function kt(t,n){const e=o=>{const s=R(o),r=n.nodeIds.get(s);if(r===void 0||(0,l.PJ)(s,n.configuration.defaultPrivacyLevel)===l.$m.HIDDEN)return;const u=Q[o.type];let i;if(u!==T.Blur&&u!==T.Focus){const a=Z(o);if(!a)return;i={id:r,type:u,x:a.x,y:a.y}}else i={id:r,type:u};t({id:n.eventIds.getIdForEvent(o),...y(g.MouseInteraction,i)})};return(0,M.l)(n.configuration,document,Object.keys(Q),e,{capture:!0,passive:!0})}const Ht=100;function q(t,n,e){const{throttled:o,cancel:s}=(0,S.n)(u=>{const i=R(u);if(!i)return;const a=e.nodeIds.get(i);if(a===void 0||(0,l.PJ)(i,e.configuration.defaultPrivacyLevel)===l.$m.HIDDEN)return;const c=i===document?{scrollTop:(0,l.zL)(),scrollLeft:(0,l.Gn)()}:{scrollTop:Math.round(i.scrollTop),scrollLeft:Math.round(i.scrollLeft)};e.elementsScrollPositions.set(i,c),n(y(g.Scroll,{id:a,x:c.scrollLeft,y:c.scrollTop}))},Ht),{stop:r}=(0,M.q)(e.configuration,t,"scroll",o,{capture:!0,passive:!0});return{stop:()=>{r(),s()}}}const $t=200;function Bt(t,n){const e=(0,l.g1)(n.configuration).subscribe(o=>{t(y(g.ViewportResize,o))});return{stop:()=>{e.unsubscribe()}}}function Ut(t,n){const e=window.visualViewport;if(!e)return{stop:S.l};const{throttled:o,cancel:s}=(0,S.n)(()=>{t({data:W(e),type:I.VisualViewport,timestamp:(0,E.nx)()})},$t,{trailing:!1}),{stop:r}=(0,M.l)(n.configuration,e,["resize","scroll"],o,{capture:!0,passive:!0});return{stop:()=>{r(),s()}}}function Gt(t,n){return(0,M.l)(n.configuration,document,["play","pause"],e=>{const o=R(e);if(!o)return;const s=n.nodeIds.get(o);s===void 0||(0,l.PJ)(o,n.configuration.defaultPrivacyLevel)===l.$m.HIDDEN||t(y(g.MediaInteraction,{id:s,type:e.type==="play"?F.Play:F.Pause}))},{capture:!0,passive:!0})}var v=m(89261);function Jt(t,n){function e(r,u){if(!r||!r.ownerNode)return;const i=n.nodeIds.get(r.ownerNode);i!==void 0&&u(i)}const o=[(0,v.H)(CSSStyleSheet.prototype,"insertRule",({target:r,parameters:[u,i]})=>{e(r,a=>t(y(g.StyleSheetRule,{id:a,adds:[{rule:u,index:i}]})))}),(0,v.H)(CSSStyleSheet.prototype,"deleteRule",({target:r,parameters:[u]})=>{e(r,i=>t(y(g.StyleSheetRule,{id:i,removes:[{index:u}]})))})];typeof CSSGroupingRule<"u"?s(CSSGroupingRule):(s(CSSMediaRule),s(CSSSupportsRule));function s(r){o.push((0,v.H)(r.prototype,"insertRule",({target:u,parameters:[i,a]})=>{e(u.parentStyleSheet,c=>{const d=tt(u);d&&(d.push(a||0),t(y(g.StyleSheetRule,{id:c,adds:[{rule:i,index:d}]})))})}),(0,v.H)(r.prototype,"deleteRule",({target:u,parameters:[i]})=>{e(u.parentStyleSheet,a=>{const c=tt(u);c&&(c.push(i),t(y(g.StyleSheetRule,{id:a,removes:[{index:c}]})))})}))}return{stop:()=>{o.forEach(r=>r.stop())}}}function tt(t){const n=[];let e=t;for(;e.parentRule;){const u=Array.from(e.parentRule.cssRules).indexOf(e);n.unshift(u),e=e.parentRule}if(!e.parentStyleSheet)return;const s=Array.from(e.parentStyleSheet.cssRules).indexOf(e);return n.unshift(s),n}function Xt(t,n){return(0,M.l)(n.configuration,window,["focus","blur"],()=>{t({data:{has_focus:document.hasFocus()},type:I.Focus,timestamp:(0,E.nx)()})})}function _t(t,n,e){const o=t.subscribe(12,s=>{var r,u;s.rawRumEvent.type===l.bb.ACTION&&s.rawRumEvent.action.type===l.X2.CLICK&&(!((u=(r=s.rawRumEvent.action.frustration)===null||r===void 0?void 0:r.type)===null||u===void 0)&&u.length)&&"events"in s.domainContext&&s.domainContext.events&&s.domainContext.events.length&&n({timestamp:s.rawRumEvent.date,type:I.FrustrationRecord,data:{frustrationTypes:s.rawRumEvent.action.frustration.type,recordIds:s.domainContext.events.map(i=>e.eventIds.getIdForEvent(i))}})});return{stop:()=>{o.unsubscribe()}}}function Wt(t,n,e){const o=t.subscribe(5,()=>{e(),n({timestamp:(0,E.nx)(),type:I.ViewEnd})});return{stop:()=>{o.unsubscribe()}}}function et(t,n,e){const o=e.configuration.defaultPrivacyLevel,s=new WeakMap,r=t!==document,{stop:u}=(0,M.l)(e.configuration,t,r?["change"]:["input","change"],d=>{const f=R(d);(f instanceof HTMLInputElement||f instanceof HTMLTextAreaElement||f instanceof HTMLSelectElement)&&a(f)},{capture:!0,passive:!0});let i;if(r)i=S.l;else{const d=[(0,v.t)(HTMLInputElement.prototype,"value",a),(0,v.t)(HTMLInputElement.prototype,"checked",a),(0,v.t)(HTMLSelectElement.prototype,"value",a),(0,v.t)(HTMLTextAreaElement.prototype,"value",a),(0,v.t)(HTMLSelectElement.prototype,"selectedIndex",a)];i=()=>{d.forEach(f=>f.stop())}}return{stop:()=>{i(),u()}};function a(d){const f=(0,l.PJ)(d,o);if(f===l.$m.HIDDEN)return;const p=d.type;let h;if(p==="radio"||p==="checkbox"){if((0,l.Ie)(d,f))return;h={isChecked:d.checked}}else{const b=C(d,f);if(b===void 0)return;h={text:b}}c(d,h);const N=d.name;p==="radio"&&N&&d.checked&&document.querySelectorAll(`input[type="radio"][name="${CSS.escape(N)}"]`).forEach(b=>{b!==d&&c(b,{isChecked:!1})})}function c(d,f){const p=e.nodeIds.get(d);if(p===void 0)return;const h=s.get(d);(!h||h.text!==f.text||h.isChecked!==f.isChecked)&&(s.set(d,f),n(y(g.Input,{id:p,...f})))}}var Yt=m(93195),jt=m(7417);const Kt=100,Zt=16;function Qt(t){let n=S.l,e=[];function o(){n(),t(e),e=[]}const{throttled:s,cancel:r}=(0,S.n)(o,Zt,{leading:!1});return{addMutations:u=>{e.length===0&&(n=(0,jt.BB)(s,{timeout:Kt})),e.push(...u)},flush:o,stop:()=>{n(),r()}}}function nt(t,n,e,o){const s=(0,l.W3)();if(!s)return{stop:S.l,flush:S.l};const r=Qt(i=>{X(2,n,e,o,a=>qt(i.concat(u.takeRecords()),a))}),u=new s((0,Yt.dm)(r.addMutations));return u.observe(t,{attributeOldValue:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{stop:()=>{u.disconnect(),r.stop()},flush:()=>{r.flush()}}}function qt(t,n){const e=new Map;t.filter(c=>c.type==="childList").forEach(c=>{c.removedNodes.forEach(d=>{ot(d,n.scope.shadowRootsController.removeShadowRoot)})});const o=t.filter(c=>c.target.isConnected&&n.scope.nodeIds.areAssignedForNodeAndAncestors(c.target)&&(0,l.PJ)(c.target,n.scope.configuration.defaultPrivacyLevel,e)!==l.$m.HIDDEN),{adds:s,removes:r,hasBeenSerialized:u}=te(o.filter(c=>c.type==="childList"),e,n),i=ee(o.filter(c=>c.type==="characterData"&&!u(c.target)),e,n),a=ne(o.filter(c=>c.type==="attributes"&&!u(c.target)),e,n);!i.length&&!a.length&&!r.length&&!s.length||n.add(y(g.Mutation,{adds:s,removes:r,texts:i,attributes:a}))}function te(t,n,e){const o=new Set,s=new Map;for(const d of t)d.addedNodes.forEach(f=>{o.add(f)}),d.removedNodes.forEach(f=>{o.has(f)||s.set(f,d.target),o.delete(f)});const r=Array.from(o);oe(r),e.serializedNodeIds=new Set;const u=[];for(const d of r){if(a(d))continue;const f=(0,l.PJ)(d.parentNode,e.scope.configuration.defaultPrivacyLevel,n);if(f===l.$m.HIDDEN||f===l.$m.IGNORE)continue;const p=L(d,f,e);if(!p)continue;const h=(0,l.$4)(d);u.push({nextId:c(d),parentId:e.scope.nodeIds.get(h),node:p})}const i=[];return s.forEach((d,f)=>{const p=e.scope.nodeIds.get(d),h=e.scope.nodeIds.get(f);p!==void 0&&h!==void 0&&i.push({parentId:p,id:h})}),{adds:u,removes:i,hasBeenSerialized:a};function a(d){var f;const p=e.scope.nodeIds.get(d);return p!==void 0&&((f=e.serializedNodeIds)===null||f===void 0?void 0:f.has(p))}function c(d){let f=d.nextSibling;for(;f;){const p=e.scope.nodeIds.get(f);if(p!==void 0)return p;f=f.nextSibling}return null}}function ee(t,n,e){var o;const s=[],r=new Set,u=t.filter(i=>r.has(i.target)?!1:(r.add(i.target),!0));for(const i of u){if(i.target.textContent===i.oldValue)continue;const c=e.scope.nodeIds.get(i.target);if(c===void 0)continue;const d=(0,l.PJ)((0,l.$4)(i.target),e.scope.configuration.defaultPrivacyLevel,n);d===l.$m.HIDDEN||d===l.$m.IGNORE||s.push({id:c,value:(o=(0,l.rf)(i.target,d))!==null&&o!==void 0?o:null})}return s}function ne(t,n,e){const o=[],s=new Map,r=t.filter(i=>{const a=s.get(i.target);return a&&a.has(i.attributeName)?!1:(a?a.add(i.attributeName):s.set(i.target,new Set([i.attributeName])),!0)}),u=new Map;for(const i of r){if(i.target.getAttribute(i.attributeName)===i.oldValue)continue;const c=e.scope.nodeIds.get(i.target);if(c===void 0)continue;const d=(0,l.PJ)(i.target,e.scope.configuration.defaultPrivacyLevel,n),f=B(i.target,d,i.attributeName,e.scope.configuration);let p;if(i.attributeName==="value"){const N=C(i.target,d);if(N===void 0)continue;p=N}else typeof f=="string"?p=f:p=null;let h=u.get(i.target);h||(h={id:c,attributes:{}},o.push(h),u.set(i.target,h)),h.attributes[i.attributeName]=p}return o}function oe(t){t.sort((n,e)=>{const o=n.compareDocumentPosition(e);return o&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:o&Node.DOCUMENT_POSITION_CONTAINS||o&Node.DOCUMENT_POSITION_FOLLOWING?1:o&Node.DOCUMENT_POSITION_PRECEDING?-1:0})}function ot(t,n){(0,l.XS)(t)&&n(t.shadowRoot),(0,l.wI)(t,e=>ot(e,n))}function se(){const t=new WeakMap;return{set(n,e){n===document&&!document.scrollingElement||t.set(n===document?document.scrollingElement:n,e)},get(n){return t.get(n)},has(n){return t.has(n)}}}const re=(t,n)=>{const e=new Map;return{addShadowRoot:(s,r)=>{if(e.has(s))return;const u=nt(s,t,n,r),i=et(s,t,r),a=q(s,t,r);e.set(s,{flush:()=>u.flush(),stop:()=>{u.stop(),i.stop(),a.stop()}})},removeShadowRoot:s=>{const r=e.get(s);r&&(r.stop(),e.delete(s))},stop:()=>{e.forEach(({stop:s})=>s())},flush:()=>{e.forEach(({flush:s})=>s())}}};function ie(){const t=new WeakMap;let n=1;return{getIdForEvent(e){return t.has(e)||t.set(e,n++),t.get(e)}}}function ue(t,n,e,o,s){return{configuration:t,elementsScrollPositions:n,eventIds:e,nodeIds:o,shadowRootsController:s}}function ae(t){const{emitRecord:n,emitStats:e,configuration:o,lifeCycle:s}=t;if(!n||!e)throw new Error("emit functions are required");const r=p=>{n(p),(0,Pt.b)("record",{record:p});const h=t.viewHistory.findView();x.$1(h.id)},u=re(r,e),i=ue(o,se(),ie(),zt(),u),{stop:a}=At(s,r,e,c,i);function c(){u.flush(),d.flush()}const d=nt(document,r,e,i),f=[d,Ft(r,i),kt(r,i),q(document,r,i),Bt(r,i),et(document,r,i),Gt(r,i),Jt(r,i),Xt(r,i),Ut(r,i),_t(s,r,i),Wt(s,r,c)];return{stop:()=>{u.stop(),f.forEach(p=>p.stop()),a()},flushMutations:c,shadowRootsController:u}}var ce=m(70583),st=m(15320);function de(t,n,e,o){const s=new FormData;s.append("segment",new Blob([t],{type:"application/octet-stream"}),`${n.session.id}-${n.start}`);const r={raw_segment_size:o,compressed_segment_size:t.byteLength,...n},u=JSON.stringify(r);return s.append("event",new Blob([u],{type:"application/json"})),{data:s,bytesCount:t.byteLength,cssText:e.cssText,isFullSnapshot:n.index_in_view===0,rawSize:o,recordCount:n.records_count,serializationDuration:e.serializationDuration}}function le({context:t,creationReason:n,encoder:e}){let o=0;const s=t.view.id,r=x.K_(s),u={start:1/0,end:-1/0,creation_reason:n,records_count:0,has_full_snapshot:!1,index_in_view:r,source:"browser",...t},i=G();x.H5(s);function a(f,p){u.start=Math.min(u.start,f.timestamp),u.end=Math.max(u.end,f.timestamp),u.records_count+=1,u.has_full_snapshot||(u.has_full_snapshot=f.type===I.FullSnapshot);const h=e.isEmpty?'{"records":[':",";e.write(h+JSON.stringify(f),N=>{o+=N,p(o)})}function c(f){Dt(i,f)}function d(f){if(e.isEmpty)throw new Error("Empty segment flushed");e.write(`],${JSON.stringify(u).slice(1)}
`),e.finish(p=>{x.L7(u.view.id,p.rawBytesCount),f(u,i,p)})}return{addRecord:a,addStats:c,flush:d}}const fe=5*E.OY;let A=6e4;function pe(t,n,e,o,s,r){return he(t,()=>me(n.applicationId,e,o),s,r)}function he(t,n,e,o){let s={status:0,nextSegmentCreationReason:"init"};const{unsubscribe:r}=t.subscribe(2,()=>{i("view_change")}),{unsubscribe:u}=t.subscribe(11,a=>{i(a.reason)});function i(a){s.status===1&&(s.segment.flush((c,d,f)=>{const p=de(f.output,c,d,f.rawBytesCount);(0,ce.Kp)(a)?e.sendOnExit(p):e.send(p)}),(0,st.DJ)(s.expirationTimeoutId)),a!=="stop"?s={status:0,nextSegmentCreationReason:a}:s={status:2}}return{addRecord:a=>{if(s.status!==2){if(s.status===0){const c=n();if(!c)return;s={status:1,segment:le({encoder:o,context:c,creationReason:s.nextSegmentCreationReason}),expirationTimeoutId:(0,st.wg)(()=>{i("segment_duration_limit")},fe)}}s.segment.addRecord(a,c=>{c>A&&i("segment_bytes_limit")})}},addStats:a=>{s.status===1&&s.segment.addStats(a)},stop:()=>{i("stop"),r(),u()}}}function me(t,n,e){const o=n.findTrackedSession(),s=e.findView();if(!(!o||!s))return{application:{id:t},session:{id:o.id},view:{id:s.id}}}function Ne(t=6e4){A=t}function ge(t,n){if(!t.metricsEnabled)return{stop:S.l};const{unsubscribe:e}=n.subscribe(o=>{if(o.type==="failure"||o.type==="queue-full"||o.type==="success"&&o.payload.isFullSnapshot){const s=Se(o.type,o.bandwidth,o.payload);(0,P.Gk)("Segment network request metrics",{metrics:s})}});return{stop:e}}function Se(t,n,e){return{cssText:{count:e.cssText.count,max:e.cssText.max,sum:e.cssText.sum},isFullSnapshot:e.isFullSnapshot,ongoingRequests:{count:n.ongoingRequestCount,totalSize:n.ongoingByteCount},recordCount:e.recordCount,result:t,serializationDuration:{count:e.serializationDuration.count,max:e.serializationDuration.max,sum:e.serializationDuration.sum},size:{compressed:e.bytesCount,raw:e.rawSize}}}function Te(t){const n=(0,V.Y9)();return{addRecord:e=>{const o=t.findView();n.send("record",e,o.id)}}}function ye(t,n,e,o,s,r,u){const i=[],a=h=>{t.notify(14,{error:h}),(0,P.A2)("Error reported to customer",{"error.message":h.message})},c=u||(0,rt.sA)([n.sessionReplayEndpointBuilder],a,A);let d,f;if((0,V.d0)())({addRecord:d}=Te(o)),f=S.l;else{const h=pe(t,n,e,o,c,s);d=h.addRecord,f=h.addStats,i.push(h.stop);const N=ge(r,c.observable);i.push(N.stop)}const{stop:p}=ae({emitRecord:d,emitStats:f,configuration:n,lifeCycle:t,viewHistory:o});return i.push(p),{stop:()=>{i.forEach(h=>h())}}}}}]);
