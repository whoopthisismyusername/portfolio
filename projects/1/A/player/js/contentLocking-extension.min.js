"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2765],{89804:(e,t)=>{t.ACHIEVEMENTS_COMPONENT_COMPLETED="ACHIEVEMENTS_COMPONENT_COMPLETED",t.ACHIEVEMENTS_RESET_COURSE="ACHIEVEMENTS_RESET_COURSE",t.achievementsComponentCompleted=e=>({type:t.ACHIEVEMENTS_COMPONENT_COMPLETED,payload:e})},63920:(e,t)=>{t.SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE="SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE",t.SET_CONTENT_LOCKING_AS_READY="SET_CONTENT_LOCKING_AS_READY",t.setContentLockingInitialState=()=>({type:t.SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE}),t.setContentLockingAsReady=()=>({type:t.SET_CONTENT_LOCKING_AS_READY})},1804:(e,t,n)=>{const c=n(52898),{bool:o,object:i}=n(23615),s=n(27378),r=n(90005),a=n(50998),l=n(40155),p=c({displayName:"ArticleLock",propTypes:{article:i.isRequired,isEnabled:o.isRequired},getLockIcon(){const{_lockIcon:e}=this.props.article._contentLocking;return"key hole"===e?"key-hole":"trophy"===e?"trophy2":e},render(){if(!this.props.isEnabled)return null;const{_contentLocking:e,_isLocked:t}=this.props.article,n=e?._lockedApperance||"default",{lockIconAriaLabel:c,_lockedText:o}=e;return s.createElement("div",{className:r("ev-article-lock",{"ev-locked":t})},s.createElement("div",{className:r(`ev-article-lock-overlay ev-article-lock-appearance-${n}`)},s.createElement("div",{className:"ev-article-lock-overlay-panel"}),s.createElement("div",{className:"ev-article-lock-strip"},s.createElement("div",{className:"ev-article-lock-circle"},s.createElement(l,{className:"ev-article-lock-icon",ariaLabel:c,icon:this.getLockIcon()}))),o?s.createElement(a,{className:"ev-article-lock-text",body:o}):null))}});e.exports=p},2452:(e,t,n)=>{const{bool:c,object:o}=n(23615),i=n(27378),{connect:s}=n(13844),r=n(1804),a=e=>i.createElement(r,e);a.propTypes={article:o.isRequired,isEnabled:c.isRequired},e.exports=s((({course:e},{article:t})=>({isEnabled:e._contentLocking?._isEnabled&&t._contentLocking?._isEnabled})))(a)},30235:(e,t,n)=>{const{registerEpics:c,registerReducer:o}=n(60633),i=n(60909),{registerContentLockingElementsEpic:s,mapAppReadyToSetupContentLockingEpic:r,setContentLockedItemsInitialStateEpic:a,checkItemsUnlockedOnContentObjectCompletedEpic:l,checkItemsUnlockedOnArticleCompletedEpic:p,checkItemsUnlockedOnComponentCompletedEpic:_,checkItemsUnlockedOnAchievementsGained:d}=n(8041);c(s,r,a,_,p,l,d),o("contentLocking",i)},8041:(e,t,n)=>{const c=n(83864),o=n(8921),{Observable:i}=n(49923),{COMPONENT_COMPLETED:s}=n(59345),{APP_READY:r,SETUP_APP:a}=n(36329),{updateContentObjects:l,CONTENT_OBJECT_COMPLETED:p}=n(64566),{updateArticles:_,ARTICLE_COMPLETED:d}=n(4718),{addElement:E}=n(15766),{addClassName:k,removeClassName:m}=n(17931),{ACHIEVEMENTS_COMPONENT_COMPLETED:T}=n(89804),{SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE:g,setContentLockingInitialState:L}=n(63920),u=n(1413),C=n(63305),O=n(14766),N=n(68353),y=n(98788),S=n(98457),I=n(2452);t.registerContentLockingElementsEpic=(e,t)=>e.filter(u(a,t)).map((()=>E({parent:"article",name:"articleLock",component:I,position:"top"}))),t.mapAppReadyToSetupContentLockingEpic=(e,t)=>e.filter((({type:e})=>{if(e!==r)return!1;const{app:{isPagePreview:n},course:c}=t.getState();return!n&&c._contentLocking?._isEnabled})).mapTo(L()),t.setContentLockedItemsInitialStateEpic=(e,t)=>e.ofType(g).mergeMap((()=>{const e=t.getState(),n=[...N(e.articles,e),...O(e.articles,e),...C(e.articles,e),...y(e.articles,e)],s=[...N(e.contentObjects,e),...O(e.contentObjects,e),...C(e.contentObjects,e),...y(e.contentObjects,e)],r=c(n,"_id"),a=c(s,"_id"),p=o(n).filter((e=>"blur"===e._contentLocking._lockedApperance)).map((e=>(e._isLocked?k:m)({_id:e._id,className:"ev-is-blurred"}))).value();return i.of(_(r),l(a),...p)})),t.checkItemsUnlockedOnComponentCompletedEpic=(e,t)=>e.filter(u(s,t)).mergeMap((()=>{const e=t.getState();return i.of(...N(e.articles,e),...N(e.contentObjects,e))})).mergeMap((e=>S(e,t.getState()))),t.checkItemsUnlockedOnArticleCompletedEpic=(e,t)=>e.filter(u(d,t)).mergeMap((()=>{const e=t.getState();return i.of(...O(e.articles,e),...O(e.contentObjects,e))})).mergeMap((e=>S(e,t.getState()))),t.checkItemsUnlockedOnContentObjectCompletedEpic=(e,t)=>e.filter(u(p,t)).mergeMap((()=>{const e=t.getState();return i.of(...C(e.articles,e),...C(e.contentObjects,e))})).mergeMap((e=>S(e,t.getState()))),t.checkItemsUnlockedOnAchievementsGained=(e,t)=>e.filter(u(T,t)).mergeMap((()=>{const e=t.getState();return i.of(...y(e.articles,e),...y(e.contentObjects,e))})).mergeMap((e=>S(e,t.getState())))},98457:(e,t,n)=>{const{Observable:c}=n(49923),{updateContentObject:o}=n(64566),{updateArticle:i}=n(4718),{addPrompt:s}=n(41466),{addClassName:r,removeClassName:a}=n(17931);e.exports=(e,t)=>{if(!t.app.isAppReady)return c.empty();const n=[];if("article"===e._type){if(n.push(i(e)),"blur"===e._contentLocking._lockedApperance){const t=e._isLocked?r:a;n.push(t({_id:e._id,className:"ev-is-blurred"}))}}else n.push(o(e));return e._isLocked||e._contentLocking._shouldDisableNotifyOnUnlock||n.push(s({title:e.displayTitle,body:t.course._contentLocking.unlockedNotifyMessage,_glyph:{_type:"icon",_icon:"unlock"}})),c.of(...n)}},1413:(e,t,n)=>{const c=n(99729);e.exports=(e,t)=>n=>{const{app:{isPagePreview:o},course:i}=t.getState();return n.type===e&&!o&&c(i,"_contentLocking._isEnabled",!1)}},98788:(e,t,n)=>{const c=n(14648),o=n(99729),i=n(34172);function s(e,t){return a(e=c(e,t.contentLocking["points gained"]),o(t,"achievements._points._currentPoints",0))}function r(e,t){return a(e=c(e,t.contentLocking["stars gained"]),o(t,"achievements._stars._currentStarsCollected",0))}function a(e,t){return i(e,((e,n)=>{const c=n._contentLocking._requiredAmount>t;return c!==n._isLocked&&e.push({_id:n._id,_isLocked:c,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e}),[])}e.exports=(e,t)=>[...s(e,t),...r(e,t)]},14766:(e,t,n)=>{const c=n(14648),o=n(34172),i=n(69238),s=n(64925),r=n(58778),a=n(78002);e.exports=(e,t)=>(e=c(e,t.contentLocking.article),o(e,((e,n)=>{let c=a(n._contentLocking._requiredCompleteIds,t);c=i(c,(e=>"article"===e._type));const o=!!s(c,(e=>!r(e,t)));return o!==n._isLocked&&e.push({_id:n._id,_isLocked:o,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e}),[]))},68353:(e,t,n)=>{const c=n(14648),o=n(34172),i=n(69238),s=n(64925),r=n(78002);e.exports=(e,t)=>(e=c(e,t.contentLocking.component),o(e,((e,n)=>{const c="correct components"===n._contentLocking._lockingType;let o=r(n._contentLocking._requiredCompleteIds,t);o=i(o,(e=>c?"component"===e._type&&e._isQuestionType:"component"===e._type));const a=!!s(o,(e=>c?!e._isComplete||!e._isCorrect:!e._isComplete));return a!==n._isLocked&&e.push({_id:n._id,_isLocked:a,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e}),[]))},63305:(e,t,n)=>{const c=n(14648),o=n(34172),i=n(69238),s=n(64925),r=n(58778),a=n(78002);e.exports=(e,t)=>(e=c(e,t.contentLocking.contentObject),o(e,((e,n)=>{let c=a(n._contentLocking._requiredCompleteIds,t);c=i(c,(e=>"page"===e._type||"menu"));const o=!!s(c,(e=>!r(e,t)));return o!==n._isLocked&&e.push({_id:n._id,_isLocked:o,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e}),[]))},60909:(e,t,n)=>{const c=n(25389),o=n(58185),i=n(72856),s=n(99729),{SETUP_APP:r}=n(36329),a={article:[],component:[],contentObject:[],"stars gained":[],"points gained":[]};e.exports=(e=a,t)=>{if(t.type===r){const{course:n,contentObjects:r,articles:l}=t.payload;if(n._contentLocking&&n._contentLocking._isEnabled){const t=c(e,(()=>[])),a=[...o(l),...o(r)];return i(a,(e=>{if(!e._contentLocking||!e._contentLocking._isEnabled)return;let c=e._contentLocking._lockingType,o=!0;"correct components"===c&&(c="component"),("stars gained"!==c||s(n,"_achievements._stars._isEnabled"))&&("points gained"!==c||s(n,"_achievements._points._isEnabled"))||(o=!1),o&&t[c].push(e._id)})),t}return a}return e}}}]);