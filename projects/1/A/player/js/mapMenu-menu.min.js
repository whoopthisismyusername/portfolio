"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[799],{65529:e=>{e.exports=function(e){const t=e.displayTitle,n=e._heroImage?._isEnabled?e._heroImage.title:null;return t||n}},71917:(e,t,n)=>{const i=n(99729),s=n(55807),o=n(95562),a=n(52898),r=n(23615),l=n(27378),{connect:m}=n(13844),c=n(90005),u=n(69525),{addPrompt:p}=n(74261),{setAriaLive:d}=n(33572),h=n(89270),g=n(92807),I=n(54157),v=n(88537),M=n(77919),f=n(90528),_=n(79529),b=n(19122),y=n(69517),C=n(31141),E=a({displayName:"MapMenu",propTypes:{menu:r.object.isRequired,device:r.object.isRequired,theme:r.object.isRequired,itemIds:r.array.isRequired,course:r.object.isRequired,addPrompt:r.func.isRequired,setAriaLive:r.func.isRequired,hasActionBar:r.bool.isRequired,classList:r.array},getInitialState(){return this.getDefaultState()},getDefaultState:()=>({_isDragging:!1,_isShowingInfo:!1,_selectedItemId:null}),componentDidMount(){const{props:e}=this;e.menu.ariaLabel&&e.setAriaLive({message:e.menu.ariaLabel,delay:200}),this.checkMapMenuImage(),this.checkMapMenuPointerImages()},checkMapMenuImage(){this.props.menu._mapMenu._mapImage||this.showErrorPrompt("No Map Menu image was found!","Make sure you have set a Map Menu image in Evolve")},checkMapMenuPointerImages(){this.getDefaultPointerImage()||o(this.props.itemIds,(e=>{const t=u(e);return!!t&&null===t._mapMenu?._pointerImage}))&&this.showErrorPrompt("No default Map Menu pointer image was found!","Make sure you have set a default menu pointer image in Evolve")},showErrorPrompt(e,t){this.props.addPrompt({title:e,body:t,_glyph:{_type:"icon",_icon:"cross"}})},getClassName(){const{props:e,state:t}=this;return c("ev-map-menu ev-menu",e.classList,{"ev-is-dragging":t._isDragging,"ev-use-menu-header-styles":e.theme._menu._settings._useMenuHeaderStyles,"ev-disable-inner-flex":e.theme._footer._settings._isStickyFooterDisabled})},getDefaultPointerImage(){const{props:e}=this;return i(e.course,"_mapMenu._defaultPointerImage")},getCloseButtonText(){const{props:e}=this;return i(e.course,"_mapMenu._closeButtonText")},getIsModalOpen(){const{state:e}=this;return!(!e._isShowingInfo&&!e._selectedItemId)},getMenuBody(){const{props:e}=this;return"course"===e.menu._type?e.menu.body:e.menu.description},onPointerClick(e){this.setState({_selectedItemId:e._id,_isShowingInfo:!1})},onInfoClick(){this.setState({_isShowingInfo:!0,_selectedItemId:null})},onInfoCloseClick(){this.setState({_isShowingInfo:!1})},onCloseMenuItemClick(){this.setState({_selectedItemId:null})},renderTitle(){const{menu:e}=this.props;if(e.displayTitle&&e._mapMenu._shouldShowTitleBar)return l.createElement(f,{title:e.displayTitle,body:this.getMenuBody(),infoOpenButtonAriaLabel:e._mapMenu.infoOpenButtonAriaLabel,onInfoClick:this.onInfoClick,isModalOpen:this.getIsModalOpen()})},renderItems(){const{props:e}=this;return s(e.itemIds,(t=>l.createElement(b,{key:t,itemId:t,defaultPointerImage:this.getDefaultPointerImage(),defaultPointerWidth:e.menu._mapMenu._defaultPointerWidth,isModalOpen:this.getIsModalOpen(),onClick:this.onPointerClick})))},renderMapMenuImage(){const e=this.props.menu._mapMenu._mapImage;if(!e)return;const{props:t,state:n}=this;return l.createElement(_,{graphic:e,alt:t.menu._mapMenu.mapImageAltText,menuImageWidth:i(t,"menu._mapMenu._menuImageWidth",1024),menuScrollableContainerMaxWidth:i(t,"menu._mapMenu._menuScrollableContainerMaxWidth",1024),device:t.device,isModalOpen:this.getIsModalOpen(),isDragging:n._isDragging,onDragStart:()=>this.setState({_isDragging:!0}),onDragEnd:()=>this.setState({_isDragging:!1})},this.renderItems())},renderInfo(){if(this.state._isShowingInfo)return l.createElement(y,{body:this.getMenuBody(),closeButtonText:this.getCloseButtonText(),onInfoCloseClick:this.onInfoCloseClick})},getShouldShowProgressBars(){const{props:e}=this,t=i(e.theme,"_menu._settings._shouldShowProgressBarsOnMenus","content"),n=i(e.menu,"_mapMenu._shouldShowProgressBarsOnMenus",!0);return"content"===t?n:"true"===t},renderMenuItem(){if(this.state._selectedItemId)return l.createElement(C,{itemId:this.state._selectedItemId,closeButtonText:this.getCloseButtonText(),onCloseMenuItemClick:this.onCloseMenuItemClick,shouldShowProgressBarsOnMenus:this.getShouldShowProgressBars(),durationIcon:this.props.theme._menu?._settings?._durationIcon})},renderActionBar(){if(this.props.hasActionBar)return l.createElement("div",{className:"ev-action-bar-container"},this.renderElements("actionBar"))},renderElements(e){return g("menu",e,{menu:this.props.menu})},render(){const e=I(),t=this.props.menu.displayTitle&&this.props.menu._mapMenu._shouldShowTitleBar?this.context+1:this.context;return l.createElement(v,null,l.createElement("div",{className:this.getClassName()},M(this.props.menu),l.createElement("main",{className:"ev-menu-container ev-map-menu-container",style:{minHeight:`calc(100vh - ${e})`},tabIndex:"-1"},l.createElement("div",{className:"menu-root"},this.renderElements("root")),l.createElement("div",{className:"ev-menu-container-inner ev-map-menu-container-inner"},this.renderTitle(),l.createElement(h.Provider,{value:t},this.renderMapMenuImage(),this.renderActionBar(),this.renderInfo(),this.renderMenuItem())),l.createElement("div",{className:"ev-menu-footer"},this.renderElements("footer")))))}});E.contextType=h,e.exports=m(null,{addPrompt:p,setAriaLive:d})(E)},79529:(e,t,n)=>{var i=n(8528);const s=n(52898),o=n(23615),a=n(27378),r=n(90005),l=n(46451),m=n(5859),c=s({displayName:"MapMenuImage",propTypes:{graphic:o.object.isRequired,device:o.object.isRequired,isModalOpen:o.bool.isRequired,isDragging:o.bool.isRequired,onDragStart:o.func.isRequired,onDragEnd:o.func.isRequired,menuImageWidth:o.number.isRequired,menuScrollableContainerMaxWidth:o.number.isRequired,alt:o.string},getInitialState:()=>({_graphicHeight:null,_graphicWidth:null,_contentHeight:null,_x:0,_y:0}),componentDidMount(){this.setInteract(),this.setContentHeight()},componentDidUpdate({device:e,menuImageWidth:t}){e.windowHeight===this.props.device.windowHeight&&e.orientation===this.props.device.orientation&&t===this.props.menuImageWidth||(this.setImageWidth(),this.setContentHeight())},componentWillUnmount(){l(this._scrollable).unset()},setInteract(){l(this._scrollable).draggable({onmove:this.onDragMove,onend:this.onDragEnd,ignoreFrom:".ev-map-menu-pointer"})},setImageWidth(){const e=this._graphic.getRef(),{naturalWidth:t,naturalHeight:n}=e,{menuImageWidth:i}=this.props,s=0===i?1024:i,o=s/(t/n);this.setState({_graphicWidth:s,_graphicHeight:o})},setContentHeight(){const{windowHeight:e}=this.props.device,{top:t}=i(".ev-container").offset(),n=e-t;this.setState({_contentHeight:n>600?600:n})},getScrollableStyle(){const{_graphicHeight:e,_graphicWidth:t,_x:n,_y:i}=this.state;return{height:e,width:t,transform:`translate(${n}px, ${i}px)`}},onDragMove(e){const{props:t}=this;t.isModalOpen||(t.isDragging||t.onDragStart(),this.setState({_x:this.state._x+e.dx,_y:this.state._y+e.dy}))},onDragEnd(){this.props.onDragEnd()},render(){const{state:e,props:t}=this;return a.createElement("div",{className:r("ev-map-menu-image",{"ev-modal-open":t.isModalOpen}),style:{height:e._contentHeight,maxWidth:t.menuScrollableContainerMaxWidth}},a.createElement("div",{ref:e=>this._scrollable=e},a.createElement("div",{className:"ev-map-menu-image-container",style:this.getScrollableStyle()},a.createElement(m,{ref:e=>this._graphic=e,graphicSrc:t.graphic,onLoad:this.setImageWidth,altText:t.alt}),this.props.children,a.createElement("div",{className:"ev-map-menu-image-overlay"}))))}});e.exports=c},69517:(e,t,n)=>{const i=n(52898),s=n(23615),o=n(27378),{Spring:a,config:r,animated:l}=n(24450),m=n(81448),c=n(40155),u=n(54794),p=i({displayName:"MapMenuInformation",propTypes:{body:s.string,closeButtonText:s.string.isRequired,onInfoCloseClick:s.func.isRequired},onInfoCloseClick(e){e.currentTarget.blur(),e.preventDefault(),this.props.onInfoCloseClick()},render(){const{props:e}=this;return o.createElement(m,null,o.createElement(a,{native:!0,from:{opacity:0},to:{opacity:1},config:r.default},(({opacity:t})=>o.createElement(l.div,{className:"ev-map-menu-information",style:{opacity:t}},o.createElement("button",{className:"ev-button ev-map-menu-button ev-map-menu-information-close-button",onClick:this.onInfoCloseClick,"aria-label":e.closeButtonText},o.createElement(c,{icon:"cross"})),o.createElement("div",{className:"ev-map-menu-information-inner"},o.createElement(u,{className:"ev-map-menu-body",html:e.body,tabIndex:"1"}),o.createElement("div",{className:"ev-map-menu-information-close-button-container"},o.createElement("button",{className:"ev-map-menu-information-close-button-mobile ev-button",onClick:this.onInfoCloseClick},e.closeButtonText)))))))}});e.exports=p},31141:(e,t,n)=>{const i=n(52898),{bool:s,func:o,number:a,object:r,string:l}=n(23615),m=n(27378),{Spring:c,config:u,animated:p}=n(24450),{MenuItemProgress:d,MenuItemHOC:h,MenuItemLink:g}=n(73931),I=n(81448),v=n(65529),M=n(96155),f=n(50998),_=n(92807),b=n(40155),y=n(54794),C=n(89270),E=i({displayName:"MapMenuItem",propTypes:{item:r.isRequired,closeButtonText:l.isRequired,onCloseMenuItemClick:o.isRequired,durationIcon:l,shouldShowProgressBarsOnMenus:s,pageMenuItemsCount:a,pageMenuItemsCompletedCount:a,completedChildrenAsPercentage:a},onCloseMenuItemClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onCloseMenuItemClick()},renderTitle(){const e=v(this.props.item);if(e)return m.createElement(M,{id:`${this.props.item._id}-title`,headingElement:`h${this.context}`,displayTitle:e,className:"ev-map-menu-item-title ev-menu-item-title",innerClassName:"ev-map-menu-item-title-inner ev-menu-item-title-inner"})},renderBody(){if(this.props.item.description)return m.createElement(f,{id:`${this.props.item._id}-description`,body:this.props.item.description,className:"ev-map-menu-item-body ev-menu-item-body",innerClassName:"ev-map-menu-item-body-inner ev-menu-item-body-inner"})},renderDurationIcon(){const{durationIcon:e}=this.props;if(e)return m.createElement(b,{icon:e,className:"ev-menu-item-duration-icon"})},renderElements(e){const{props:t}=this;return _("menuItem",e,{item:t.item})},render(){const{item:e,closeButtonText:t,pageMenuItemsCompletedCount:n,pageMenuItemsCount:i,completedChildrenAsPercentage:s,shouldShowProgressBarsOnMenus:o}=this.props;return m.createElement(I,null,m.createElement(c,{native:!0,from:{opacity:0},to:{opacity:1},config:u.default},(({opacity:a})=>m.createElement(p.div,{className:"ev-map-menu-item ev-menu-item ev-collection-item",style:{opacity:a}},m.createElement("button",{className:"ev-button ev-map-menu-button ev-map-menu-items-close-button",onClick:this.onCloseMenuItemClick,"aria-label":t},m.createElement(b,{icon:"cross"})),m.createElement("div",{className:"ev-map-menu-item-inner ev-clearfix"},m.createElement("div",{className:"ev-map-menu-item-content-container ev-collection-item-content-inner"},this.renderTitle(),this.renderBody(),m.createElement("div",{className:"ev-map-menu-item-duration ev-menu-item-duration"},m.createElement("div",{className:"ev-map-menu-item-duration-inner ev-menu-item-duration-inner"},this.renderDurationIcon(),m.createElement("span",{className:"ev-menu-item-duration-label"},e.durationLabel),m.createElement(y,{element:"span",html:e.duration}))),this.renderElements("content"),o&&m.createElement(d,{item:e,pageMenuItemsCompletedCount:n,pageMenuItemsCount:i,completedChildrenAsPercentage:s})),m.createElement("div",{className:"ev-map-menu-item-buttons ev-collection-item-footer"},m.createElement("div",{className:"ev-collection-item-footer-inner"},m.createElement(g,{id:e._id,isLocked:e._isLocked,isVisited:e._isVisited,linkText:e.linkText,linkIcon:e.linkIcon,isLinkIconRightPosition:e.isLinkIconRightPosition,link:`/${e._type}/${e._id}`}),m.createElement("button",{className:"ev-map-menu-item-close-button-mobile ev-button",onClick:this.onCloseMenuItemClick},t))))))))}});E.contextType=C,e.exports=h(E)},19122:(e,t,n)=>{const i=n(99729),s=n(52898),o=n(23615),a=n(27378),{Motion:r,spring:l}=n(59439),m=n(90005),{connect:c}=n(13844),u=n(5859),p=s({displayName:"MapMenuPointer",propTypes:{item:o.object.isRequired,defaultPointerImage:o.object,defaultPointerWidth:o.number,onClick:o.func.isRequired,isModalOpen:o.bool.isRequired},getInitialState:()=>({_isHovering:!1}),onMouseEnter(){const{isModalOpen:e}=this.props;e||this.setState({_isHovering:!0})},onMouseLeave(){this.setState({_isHovering:!1})},onClick(e){const{props:t}=this;e.preventDefault(),t.isModalOpen||t.onClick(t.item)},getPointerImage(){const{props:e}=this,t=e.item._mapMenu?._pointerImage;return t||e.defaultPointerImage},getPointerImageStyle(){const{props:e}=this,t={},n=e.item._mapMenu._pointerWidth||e.defaultPointerWidth;return n&&(t.width=`${n}px`,t.maxWidth="none"),t},getStyle({scale:e,opacity:t}){const{props:n}=this,s=i(n.item,"_mapMenu._position",{_top:50,_left:50});return{top:`${s._top}%`,left:`${s._left}%`,transform:`translate(-50%, -50%) scale(${e})`,opacity:t}},getMotionStyle(){const{state:e,props:t}=this,n=t.isModalOpen?.5:1,i=e._isHovering?1.2:1;return{scale:l(i,{stiffness:175,damping:e._isHovering?12:20}),opacity:l(n)}},render(){const{props:e}=this;return a.createElement(r,{defaultStyle:{scale:1,opacity:1},style:this.getMotionStyle()},(t=>a.createElement("button",{className:m("ev-map-menu-pointer ev-has-aria-label",{"ev-is-disabled":e.isModalOpen}),style:this.getStyle(t),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick,"aria-label":this.props.item.title},a.createElement(u,{isAriaHidden:!0,graphicSrc:this.getPointerImage(),style:this.getPointerImageStyle()}))))}});e.exports=c(((e,t)=>({item:e.contentObjects[t.itemId]})))(p)},90528:(e,t,n)=>{const i=n(52898),s=n(23615),o=n(27378),a=n(90005),r=n(96155),l=n(40155),m=n(89270),c=i({displayName:"MapMenuTitle",propTypes:{title:s.string.isRequired,body:s.string,onInfoClick:s.func.isRequired,isModalOpen:s.bool.isRequired,infoOpenButtonAriaLabel:s.string},onInfoClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onInfoClick()},renderInfoButton(){const{props:e}=this;if(e.body)return o.createElement("button",{className:a("ev-map-menu-button ev-map-menu-information-button",{"ev-disabled":e.isModalOpen,"ev-has-aria-label":!!e.infoOpenButtonAriaLabel}),disabled:e.isModalOpen,onClick:this.onInfoClick,"aria-label":e.infoOpenButtonAriaLabel},o.createElement(l,{icon:"question"}))},render(){return o.createElement(r,{headingElement:`h${this.context}`,displayTitle:this.props.title,className:"ev-map-menu-title",innerClassName:"ev-map-menu-title-inner"},(e=>o.createElement(o.Fragment,null,e,this.renderInfoButton())))}});c.contextType=m,e.exports=c},69212:(e,t,n)=>{const{registerMenu:i}=n(60633);i("mapMenu",n(71917))}}]);